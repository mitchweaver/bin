#!/bin/sh
#
# https://github.com/mitchweaver/bin
#
# tries to intelligently determine if a wayland or x11 session exists
# ========================================================================

isX() { echo X11     ; exit ; }
isW() { echo wayland ; exit ; }

# Note: this is often unset for same reason above
#       when launching sway from tty
[ -e "$XDG_SESSION_ID" ] && isW

# sometimes this works
pgrep -f wayland-session >/dev/null && isW
pgrep -f seatd >/dev/null && isW

# Note: not reliable, when starting sway from tty not a DM this reports "tty"
if command -v loginctl >/dev/null ; then
    string=$(loginctl show-session "$XDG_SESSION_ID" -p Type)
    string=${string#Type=}
    case $string in
        wayland)
            isW
            ;;
        *)
            isX
    esac
fi

# if we're still here, undeterminable
echo UNKNOWN
